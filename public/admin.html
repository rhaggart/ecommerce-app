


    
    
    Admin Panel
    


    
        Admin Panel
        
            Shop
            Orders
            Logout
        
    

    
        
            Add New Product
            
                
                
                
                
                
                    Select Category
                    Electronics
                    Clothing
                    Books
                    Home
                    Sports
                    Other
                
                
                Add Product
            
        

        
            Manage Products
            
        
    

    
        const token = localStorage.getItem('token');
        if (!token) {
            window.location.href = 'login.html';
        }

        const form = document.getElementById('productForm');
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData();
            formData.append('name', document.getElementById('name').value);
            formData.append('description', document.getElementById('description').value);
            formData.append('price', document.getElementById('price').value);
            formData.append('quantity', document.getElementById('quantity').value);
            formData.append('category', document.getElementById('category').value);
            formData.append('image', document.getElementById('image').files[0]);

            try {
                const response = await fetch('/api/admin/products', {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${token}` },
                    body: formData
                });

                if (response.ok) {
                    alert('Product added successfully!');
                    form.reset();
                    loadAdminProducts();
                } else if (response.status === 401) {
                    alert('Session expired. Please login again.');
                    logout();
                } else {
                    alert('Error adding product');
                }
            } catch (err) {
                console.error('Error:', err);
                alert('Error adding product');
            }
        });

        async function loadAdminProducts() {
            try {
                const response = await fetch('/api/products');
                const products = await response.json();
                
                const container = document.getElementById('adminProducts');
                container.innerHTML = '';

                products.forEach(product => {
                    const productItem = `
                        
                            
                            
                                ${product.name}
                                ${product.description}
                                Category: ${product.category}
                                Price: $${product.price.toFixed(2)}
                                Quantity: ${product.quantity}
                            
                            Delete
                        
                    `;
                    container.innerHTML += productItem;
                });
            } catch (err) {
                console.error('Error loading products:', err);
            }
        }

        async function deleteProduct(id) {
            if (confirm('Are you sure you want to delete this product?')) {
                try {
                    const response = await fetch(`/api/admin/products/${id}`, {
                        method: 'DELETE',
                        headers: { 'Authorization': `Bearer ${token}` }
                    });

                    if (response.ok) {
                        alert('Product deleted successfully!');
                        loadAdminProducts();
                    } else if (response.status === 401) {
                        alert('Session expired. Please login again.');
                        logout();
                    } else {
                        alert('Error deleting product');
                    }
                } catch (err) {
                    console.error('Error:', err);
                    alert('Error deleting product');
                }
            }
        }

        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            window.location.href = 'login.html';
        }

        loadAdminProducts();